<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NEW NERD - Gerador de Quest√µes</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéì</text></svg>"
    />
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>

  <!-- ‚¨áÔ∏è classe para escopar estilos do chat (posi√ß√£o √† esquerda) -->
  <body class="page-gerador">
    <div class="layout">
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <h3>üìö Hist√≥rico</h3>
          <button class="btn-icon" onclick="toggleSidebar()" title="Fechar">
            √ó
          </button>
        </div>

        <div class="dashboard">
          <h3>üìä Estat√≠sticas</h3>
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-value" id="statTotal">0</div>
              <div class="stat-label">Quest√µes</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="statCusto">$0.00</div>
              <div class="stat-label">Custo Total</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="statTokens">0</div>
              <div class="stat-label">Tokens</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="statMedia">$0.00</div>
              <div class="stat-label">Custo M√©dio</div>
            </div>
          </div>

          <div class="chart-container">
            <div class="chart-bar">
              <div class="chart-label">M√∫ltipla</div>
              <div class="chart-progress">
                <div class="chart-fill" id="chartMC" style="width: 0%"></div>
                <div class="chart-count" id="countMC">0</div>
              </div>
            </div>
            <div class="chart-bar">
              <div class="chart-label">Discursiva</div>
              <div class="chart-progress">
                <div class="chart-fill" id="chartDisc" style="width: 0%"></div>
                <div class="chart-count" id="countDisc">0</div>
              </div>
            </div>
            <div class="chart-bar">
              <div class="chart-label">V ou F</div>
              <div class="chart-progress">
                <div class="chart-fill" id="chartVF" style="width: 0%"></div>
                <div class="chart-count" id="countVF">0</div>
              </div>
            </div>
            <div class="chart-bar">
              <div class="chart-label">Associa√ß√£o</div>
              <div class="chart-progress">
                <div class="chart-fill" id="chartAssoc" style="width: 0%"></div>
                <div class="chart-count" id="countAssoc">0</div>
              </div>
            </div>
          </div>
        </div>

        <div class="sidebar-filters">
          <div class="filter-group">
            <label for="filterTipo">Tipo de Quest√£o</label>
            <select id="filterTipo" onchange="applyFilters()">
              <option value="">Todos</option>
              <option value="multipla_escolha">M√∫ltipla Escolha</option>
              <option value="discursiva">Discursiva</option>
              <option value="verdadeiro_falso">Verdadeiro/Falso</option>
              <option value="associacao">Associa√ß√£o</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="filterDisciplina">Disciplina</label>
            <select id="filterDisciplina" onchange="applyFilters()">
              <option value="">Todas</option>
              <option value="Matem√°tica">Matem√°tica</option>
              <option value="Portugu√™s">Portugu√™s</option>
              <option value="Biologia">Biologia</option>
              <option value="Qu√≠mica">Qu√≠mica</option>
              <option value="F√≠sica">F√≠sica</option>
              <option value="Hist√≥ria">Hist√≥ria</option>
              <option value="Geografia">Geografia</option>
              <option value="Ingl√™s">Ingl√™s</option>
              <option value="Filosofia">Filosofia</option>
              <option value="Sociologia">Sociologia</option>
            </select>
          </div>

          <div class="filter-group">
            <label for="filterData">Per√≠odo</label>
            <select id="filterData" onchange="applyFilters()">
              <option value="">Todos</option>
              <option value="hoje">Hoje</option>
              <option value="semana">√öltima Semana</option>
              <option value="mes">√öltimo M√™s</option>
            </select>
          </div>

          <button class="filter-clear" onclick="clearFilters()">
            üóëÔ∏è Limpar Filtros
          </button>
        </div>

        <div class="search-box">
          <input
            type="text"
            class="search-input"
            id="searchInput"
            placeholder="üîç Buscar quest√µes..."
            oninput="searchQuestions()"
          />
        </div>

        <div class="sidebar-content" id="historico">
          <div style="text-align: center; color: #999; padding: 20px">
            Nenhuma quest√£o gerada ainda
          </div>
        </div>

        <div class="sidebar-footer">
          <button class="btn btn-small btn-danger" onclick="clearHistory()">
            üóëÔ∏è Limpar Hist√≥rico
          </button>
        </div>
      </aside>

      <main class="main-content">
        <div class="container">
          <div class="header">
            <button class="btn-icon menu-toggle" onclick="toggleSidebar()">
              ‚ò∞
            </button>
            <div>
              <h1>üéì NEW NERD</h1>
              <p>Gerador de Quest√µes com Intelig√™ncia Artificial</p>
              <a
                href="./biblioteca-professor.html"
                class="btn btn-small"
                style="margin-top: 0.5rem; display: inline-block"
                >üìö Biblioteca do Professor</a
              >
            </div>
          </div>

          <div class="main-card">
            <form id="questionForm">
              <div
                class="mode-tabs"
                style="
                  display: flex;
                  gap: 10px;
                  margin-bottom: 20px;
                  border-bottom: 2px solid #e0e0e0;
                "
              >
                <button
                  type="button"
                  class="mode-tab active"
                  onclick="switchMode('individual')"
                  style="
                    flex: 1;
                    padding: 12px;
                    border: none;
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    color: white;
                    border-radius: 8px 8px 0 0;
                    font-weight: 600;
                  "
                >
                  üìù Quest√£o Individual
                </button>
                <button
                  type="button"
                  class="mode-tab"
                  onclick="switchMode('prova')"
                  style="
                    flex: 1;
                    padding: 12px;
                    border: none;
                    background: #f5f5f5;
                    color: #666;
                    border-radius: 8px 8px 0 0;
                    font-weight: 600;
                  "
                >
                  üìã Prova Completa
                </button>
              </div>

              <div id="individualPanel">
                <div class="form-group">
                  <label for="tema">üîñ Tema ou T√≥pico</label>
                  <input
                    type="text"
                    id="tema"
                    placeholder="Ex: Revolu√ß√£o Francesa..."
                    required
                  />
                </div>
                <div class="form-group">
                  <label>üéØ Crit√©rios (Opcional)</label>
                  <textarea
                    id="criterios"
                    class="form-control"
                    rows="2"
                  ></textarea>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="disciplina">üìö Disciplina</label>
                    <select id="disciplina">
                      <option value="auto">Autom√°tico</option>
                      <option value="Matem√°tica">Matem√°tica</option>
                      <option value="Portugu√™s">Portugu√™s</option>
                      <option value="Biologia">Biologia</option>
                      <option value="Hist√≥ria">Hist√≥ria</option>
                      <option value="Geografia">Geografia</option>
                      <option value="F√≠sica">F√≠sica</option>
                      <option value="Qu√≠mica">Qu√≠mica</option>
                      <option value="Ingl√™s">Ingl√™s</option>
                      <option value="Filosofia">Filosofia</option>
                      <option value="Sociologia">Sociologia</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="tipo">üìä Tipo</label>
                    <select id="tipo">
                      <option value="multipla_escolha">M√∫ltipla Escolha</option>
                      <option value="discursiva">Discursiva</option>
                      <option value="verdadeiro_falso">
                        Verdadeiro ou Falso
                      </option>
                      <option value="associacao">Associa√ß√£o</option>
                    </select>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="serie">üéì S√©rie</label>
                    <select id="serie">
                      <option value="3¬∫ Ano">3¬∫ Ano</option>
                      <option value="2¬∫ Ano">2¬∫ Ano</option>
                      <option value="1¬∫ Ano">1¬∫ Ano</option>
                      <option value="9¬∫ Ano">9¬∫ Ano</option>
                      <option value="8¬∫ Ano">8¬∫ Ano</option>
                      <option value="7¬∫ Ano">7¬∫ Ano</option>
                      <option value="6¬∫ Ano">6¬∫ Ano</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="dificuldade">‚ö° Dificuldade</label>
                    <select id="dificuldade">
                      <option value="f√°cil">F√°cil</option>
                      <option value="m√©dia">M√©dia</option>
                      <option value="dif√≠cil">Dif√≠cil</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="quantidade">üî¢ Quantidade</label>
                    <select id="quantidade">
                      <option value="1">1</option>
                      <option value="3">3</option>
                      <option value="5">5</option>
                      <option value="10">10</option>
                    </select>
                  </div>
                </div>
                <button type="submit" class="btn" id="generateBtn">
                  ‚ú® Gerar Quest√£o
                </button>
              </div>
            </form>

            <div
              id="provaPanel"
              style="display: none; padding: 20px; text-align: center"
            >
              Modo Prova em desenvolvimento
            </div>

            <div class="error" id="error"></div>
            <div class="loading" id="loading">
              <div class="spinner"></div>
              <p>Gerando...</p>
              <div id="progressContainer" style="display: none">
                <div id="progressFill"></div>
              </div>
            </div>
            <div class="result" id="result"></div>
          </div>
        </div>
      </main>
    </div>

    <!-- Bot√£o flutuante do CHAT -->
    <button class="chat-widget-btn" type="button" onclick="toggleChat()">
      ü§ñ
    </button>

    <!-- Modal do CHAT -->
    <div class="chat-modal" id="chatModal">
      <iframe
        src="chat-professor.html"
        class="chat-frame"
        style="width: 100%; height: 100%; border: none"
      ></iframe>
    </div>

    <!-- Bot√£o do tema (o script cria/ajusta se n√£o existir) -->
    <button
      id="themeToggle"
      class="theme-toggle"
      type="button"
      title="Alternar tema"
    ></button>

    <!-- Carrega por √∫ltimo -->
    <script src="js/theme.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

    <script src="js/config.js"></script>
    <script src="js/supabase.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/generator.js"></script>
    <script src="js/export.js"></script>
    <script src="js/app.js"></script>
    <script src="js/history.js"></script>
    <script src="js/dashboard.js"></script>

    <script>
      function toggleChat() {
        document.getElementById("chatModal").classList.toggle("active");
      }
    </script>
  </body>
</html>
